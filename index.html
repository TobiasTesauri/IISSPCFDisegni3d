<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IISS Piera Cillario Ferrero - Progetti 3D</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    <style>
        :root{ --bg:#FFFDF9; --card:#FFFFFF; --accent:#2F5D41; --muted:#4B5563; --glass:rgba(255,255,255,0.92); --max-width:1160px; --radius:12px }
        *{box-sizing:border-box;margin:0;padding:0}
        html,body{height:100%}
        body{font-family:'Inter',system-ui,-apple-system,'Segoe UI',Roboto,Arial;background:linear-gradient(180deg,#fff 0%,#fbfbfb 100%);color:#0b1720}
        .container{max-width:var(--max-width);margin:28px auto;padding:22px}

        header{display:flex;align-items:center;gap:18px;background:var(--glass);padding:16px;border-radius:14px;box-shadow:0 8px 24px rgba(3,10,10,0.06)}
        #schoolLogo{height:72px;width:auto;border-radius:8px;object-fit:contain}
        .site-title{flex:1}
        .site-title h1{font-family:'Playfair Display',serif;color:var(--accent);font-size:1.6rem;margin-bottom:4px}
        .site-title p{color:var(--muted);font-size:0.95rem}

        .nav-buttons{display:flex;gap:10px}
        .btn{padding:10px 16px;border-radius:10px;border:none;cursor:pointer;font-weight:700;display:inline-flex;align-items:center;gap:8px}
        .btn-primary{background:var(--accent);color:#fff}
        .btn-ghost{background:transparent;border:2px solid var(--accent);color:var(--accent)}

        .section{display:none;margin-top:18px;background:var(--card);padding:22px;border-radius:12px;box-shadow:0 10px 30px rgba(2,6,23,0.04)}
        .section.active{display:block}

        .hero{padding:28px;border-radius:10px;background:linear-gradient(90deg,#f8fff8,#ffffff);margin-bottom:14px}
        .hero h2{font-family:'Playfair Display',serif;color:var(--accent);font-size:1.9rem;margin-bottom:8px}
        .hero p{color:var(--muted);font-size:1.02rem}

    .class-header{display:flex;align-items:center;gap:16px;margin-bottom:14px}
    .class-header h3{margin:0;color:var(--accent)}
    /* header transition: slide + fade */
    .class-header.transitioning{animation:headerSlide .42s ease both}
    @keyframes headerSlide{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}
    .gallery{display:flex;flex-wrap:wrap;gap:12px;min-height:44px}
    /* hero media: center and size video */
    .hero-media{display:flex;flex-direction:column;align-items:center;margin-top:14px}
    .hero-media video{width:100%;max-width:640px;height:auto;display:block;margin:0 auto;border-radius:10px;border:1px solid #eee}
    .hero-media .caption{margin-top:8px;color:var(--muted);font-size:0.95rem;text-align:center}
        .gallery img{width:calc(20% - 10px);border-radius:10px;object-fit:cover;border:1px solid #eee;cursor:pointer}
        @media (max-width:900px){.gallery img{width:calc(50% - 10px)}}

        footer{margin-top:18px;text-align:center;color:var(--muted);font-size:0.95rem}

        /* Lightbox */
        .lightbox{
            position:fixed;
            inset:0;
            display:none;
            align-items:center;
            justify-content:center;
            background:rgba(6,6,8,0.72);
            z-index:1000;
            padding:24px;
        }
        .lightbox.open{display:flex}
        .lightbox-content{position:relative;max-width:92%;max-height:92%;display:flex;align-items:center;justify-content:center}
        .lightbox img{max-width:100%;max-height:100%;border-radius:8px;box-shadow:0 18px 40px rgba(2,6,23,0.6)}
        .lightbox .close, .lightbox .nav{
            position:absolute;background:rgba(255,255,255,0.14);border:0;color:#fff;padding:8px 12px;border-radius:8px;backdrop-filter:blur(4px);cursor:pointer;font-weight:700
        }
        .lightbox .close{top:-10px;right:-10px}
        .lightbox .nav.prev{left:-10px;top:50%;transform:translateY(-50%)}
        .lightbox .nav.next{right:-10px;top:50%;transform:translateY(-50%)}
        @media (max-width:600px){ .lightbox .nav.prev, .lightbox .nav.next{display:none} }

    </style>
</head>
<body>
    <div class="container">
        <header>
            <img id="schoolLogo" src="logo.png" alt="Logo IISS Piera Cillario Ferrero" onerror="this.style.display='none'">
            <div class="site-title">
                <h1>Progetti 3D — IISS Piera Cillario Ferrero</h1>
                <p class="subtitle">Cortemilia · Industria e Artigianato • Sezione progetti studenti</p>
            </div>
            <div class="nav-buttons" role="navigation" aria-label="Navigazione principale">
                <button class="btn btn-primary" onclick="showSection('home')">Home</button>
                <button class="btn btn-ghost" onclick="showSection('class-3e')">Classe 3e</button>
                <button class="btn btn-ghost" onclick="showSection('class-4e')">Classe 4e</button>
                <button class="btn btn-ghost" onclick="showSection('class-5e')">Classe 5e</button>
            </div>
        </header>

        <div id="home" class="section active">
            <div class="hero">
                <h2>Benvenuti alla vetrina dei progetti 3D</h2>
                <p>Nel laboratorio dell'IISS Piera Cillario Ferrero trasformiamo idee in oggetti concreti: disegniamo i modelli con Autodesk Inventor, li perfezioniamo e li realizziamo con le tecnologie del laboratorio.</p>

                <div class="hero-media">
                    <video id="introVideo" src="veronica_intro.mp4" poster="veronica_intro.jpg" muted autoplay loop playsinline>
                        Il tuo browser non supporta il tag video.
                    </video>
                    <div class="caption"><em>Disegnato da Veronica Pavarino ed Ilaria Scaccianoce.</em></div>
                </div>
            </div>
        </div>

        <div id="class-3e" class="section">
            <button class="btn btn-ghost" onclick="showSection('home')">← Torna alla Home</button>
            <div class="class-header"><h3>Classe 3e — Progetti 3D</h3><p style="color:var(--muted);margin-left:auto">Anno scolastico 2025–2026</p></div>
            <div id="gallery-3e" class="gallery" aria-live="polite"></div>
        </div>

        <div id="class-4e" class="section">
            <button class="btn btn-ghost" onclick="showSection('home')">← Torna alla Home</button>
            <div class="class-header"><h3>Classe 4e — Progetti 3D</h3><p style="color:var(--muted);margin-left:auto">Anno scolastico 2025–2026</p></div>
            <div id="gallery-4e" class="gallery" aria-live="polite"></div>
        </div>

        <div id="class-5e" class="section">
            <button class="btn btn-ghost" onclick="showSection('home')">← Torna alla Home</button>
            <div class="class-header"><h3>Classe 5e — Progetti 3D</h3><p style="color:var(--muted);margin-left:auto">Anno scolastico 2025–2026</p></div>
            <div id="gallery-5e" class="gallery" aria-live="polite"></div>
        </div>

        <footer>
            IISS Piera Cillario Ferrero — Cortemilia · Sezione progetti 3D
        </footer>
    </div>

    <!-- Lightbox markup -->
    <div id="lightbox" class="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
        <div class="lightbox-content">
            <button class="close" aria-label="Chiudi">✕</button>
            <button class="nav prev" aria-label="Immagine precedente">←</button>
            <img src="" alt="">
            <button class="nav next" aria-label="Immagine successiva">→</button>
        </div>
    </div>

    <script>
        // show/hide sections with header transition when switching class pages
        function showSection(id){
            const prev = document.querySelector('.section.active');
            if(prev && prev.id !== id) prev.classList.remove('active');
            const t=document.getElementById(id);
            if(t) {
                t.classList.add('active');
                const hdr = t.querySelector('.class-header');
                if(hdr){
                    hdr.classList.remove('transitioning');
                    void hdr.offsetWidth;
                    hdr.classList.add('transitioning');
                    hdr.addEventListener('animationend', function once(){ hdr.classList.remove('transitioning'); hdr.removeEventListener('animationend', once); });
                }
            }
            setTimeout(()=>{ t && t.scrollIntoView({behavior:'smooth'}); }, 60);
        }

        // Genera gallerie per le classi 3e,4e,5e con immagini d1<classe>.(png|jpg|jpeg)
        // Modifica richiesta: NON mostrare testi o placeholder quando i file mancano.
        function generateGalleries(){
            const classes=['3e','4e','5e'];
            const exts = ['png','jpg','jpeg','PNG','JPG','JPEG'];

            classes.forEach(cls=>{
                const container=document.getElementById('gallery-'+cls);
                if(!container) return;

                for(let i=1;i<=5;i++){
                    const base = `d${i}${cls}`; // es. d13e
                    let resolved = false;
                    const tried = [];

                    exts.forEach((ext) => {
                        const src = `${base}.${ext}`;
                        const probe = new Image();

                        probe.onload = function(){
                            if(resolved) return;
                            resolved = true;
                            probe.alt = `Progetto ${i} classe ${cls}`;
                            probe.loading = 'lazy';
                            probe.title = `${base}.${ext}`;
                            probe.tabIndex = 0;
                            probe.addEventListener('click', () => openLightbox(container, probe));
                            probe.addEventListener('keydown', (ev) => { if(ev.key === 'Enter' || ev.key === ' ') { ev.preventDefault(); openLightbox(container, probe); } });
                            container.appendChild(probe);
                        };

                        probe.onerror = function(){
                            tried.push(src);
                            // Non mostrare alcun messaggio visibile: semplicemente ignoriamo i file mancanti.
                            // (Se necessario per debug, possiamo lasciare console.warn, ma per ora non lo usiamo.)
                        };

                        probe.src = src;
                    });
                }
            });
        }

        // Lightbox implementation (supports prev/next within the same gallery)
        const lb = document.getElementById('lightbox');
        const lbImg = lb.querySelector('img');
        const btnClose = lb.querySelector('.close');
        const btnPrev = lb.querySelector('.nav.prev');
        const btnNext = lb.querySelector('.nav.next');

        function openLightbox(container, imgEl){
            const imgs = Array.from(container.querySelectorAll('img'));
            let index = imgs.indexOf(imgEl);
            if(index < 0) return;

            function showIndex(i){
                const el = imgs[i];
                lbImg.src = el.src;
                lbImg.alt = el.alt || '';
                lb.setAttribute('aria-label', `${el.alt || 'Immagine'} — ${i+1} di ${imgs.length}`);
                currentIndex = i;
            }

            let currentIndex = index;
            showIndex(currentIndex);

            lb.classList.add('open');
            lb.setAttribute('aria-hidden', 'false');
            btnClose.focus();

            const onKey = (e) => {
                if(e.key === 'Escape'){ closeLightbox(); }
                else if(e.key === 'ArrowLeft'){ navigate(-1); }
                else if(e.key === 'ArrowRight'){ navigate(1); }
            };
            const onClickOutside = (e) => { if(e.target === lb) closeLightbox(); };

            function navigate(delta){
                if(!imgs.length) return;
                currentIndex = (currentIndex + delta + imgs.length) % imgs.length;
                showIndex(currentIndex);
            }

            function closeLightbox(){
                lb.classList.remove('open');
                lb.setAttribute('aria-hidden', 'true');
                lbImg.src = '';
                document.removeEventListener('keydown', onKey);
                lb.removeEventListener('click', onClickOutside);
            }

            btnClose.onclick = closeLightbox;
            btnPrev.onclick = () => navigate(-1);
            btnNext.onclick = () => navigate(1);

            document.addEventListener('keydown', onKey);
            lb.addEventListener('click', onClickOutside);
        }

        document.addEventListener('DOMContentLoaded', ()=>{ generateGalleries(); });
    </script>
</body>
</html>
